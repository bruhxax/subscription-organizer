<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –ø–æ–¥–ø–∏—Å–æ–∫</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- Loader -->
    <div id="loader" class="loader">
        <div class="spinner"></div>
    </div>

    <!-- Main Container -->
    <div id="app" class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">üí≥ –ú–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏</h1>
                <button id="themeToggle" class="theme-toggle">üåô</button>
            </div>
        </header>

        <!-- Stats Dashboard -->
        <section class="stats-dashboard">
            <div class="stat-card primary">
                <div class="stat-icon">üí∞</div>
                <div class="stat-info">
                    <div class="stat-label">–ú–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</div>
                    <div class="stat-value" id="monthlyExpense">$0.00</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-info">
                    <div class="stat-label">–ì–æ–¥–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</div>
                    <div class="stat-value" id="yearlyExpense">$0.00</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    <div class="stat-value" id="activeCount">0</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üîî</div>
                <div class="stat-info">
                    <div class="stat-label">–°–∫–æ—Ä–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ</div>
                    <div class="stat-value" id="upcomingCount">0</div>
                </div>
            </div>
        </section>

        <!-- Filters and Sort -->
        <section class="controls">
            <div class="filter-group">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                <button class="filter-btn" data-filter="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</button>
            </div>
            <div class="sort-group">
                <select id="sortSelect" class="sort-select">
                    <option value="date">–ü–æ –¥–∞—Ç–µ</option>
                    <option value="price">–ü–æ —Ü–µ–Ω–µ</option>
                    <option value="name">–ü–æ –∏–º–µ–Ω–∏</option>
                    <option value="category">–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                </select>
            </div>
        </section>

        <!-- Subscriptions List -->
        <section class="subscriptions-section">
            <div id="subscriptionsList" class="subscriptions-list">
                <!-- Subscriptions will be rendered here -->
            </div>
            
            <!-- Empty State -->
            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-icon">üì≠</div>
                <h3>–ù–µ—Ç –ø–æ–¥–ø–∏—Å–æ–∫</h3>
                <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã</p>
            </div>
        </section>

        <!-- Add Button -->
        <button id="addBtn" class="add-btn" title="–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É">
            <span class="add-icon">+</span>
        </button>
    </div>

    <!-- Modal for Add/Edit Subscription -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <form id="subscriptionForm" class="subscription-form">
                <div class="form-group">
                    <label for="subName">–ù–∞–∑–≤–∞–Ω–∏–µ <span class="required">*</span></label>
                    <input type="text" id="subName" name="name" required placeholder="Netflix, Spotify...">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="subPrice">–¶–µ–Ω–∞ <span class="required">*</span></label>
                        <input type="number" id="subPrice" name="price" step="0.01" required placeholder="9.99">
                    </div>
                    <div class="form-group">
                        <label for="subCurrency">–í–∞–ª—é—Ç–∞</label>
                        <select id="subCurrency" name="currency">
                            <option value="USD">USD $</option>
                            <option value="EUR">EUR ‚Ç¨</option>
                            <option value="RUB">RUB ‚ÇΩ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="subCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è <span class="required">*</span></label>
                    <select id="subCategory" name="category" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        <option value="Streaming">üì∫ –°—Ç—Ä–∏–º–∏–Ω–≥</option>
                        <option value="Music">üéµ –ú—É–∑—ã–∫–∞</option>
                        <option value="Gaming">üéÆ –ò–≥—Ä—ã</option>
                        <option value="Education">üìö –û–±—É—á–µ–Ω–∏–µ</option>
                        <option value="Work">üíº –†–∞–±–æ—Ç–∞</option>
                        <option value="VPN">üîí VPN</option>
                        <option value="Cloud Storage">‚òÅÔ∏è –û–±–ª–∞–∫–æ</option>
                        <option value="Fitness">üí™ –§–∏—Ç–Ω–µ—Å</option>
                        <option value="News">üì∞ –ù–æ–≤–æ—Å—Ç–∏</option>
                        <option value="Software">üíª –ü–û</option>
                        <option value="Other">üì¶ –î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="subBilling">–ü–µ—Ä–∏–æ–¥ –æ–ø–ª–∞—Ç—ã</label>
                    <select id="subBilling" name="billing_cycle">
                        <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
                        <option value="yearly">–ï–∂–µ–≥–æ–¥–Ω–æ</option>
                        <option value="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="subStartDate">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ <span class="required">*</span></label>
                        <input type="date" id="subStartDate" name="start_date" required>
                    </div>
                    <div class="form-group">
                        <label for="subNextPayment">–°–ª–µ–¥. –ø–ª–∞—Ç—ë–∂ <span class="required">*</span></label>
                        <input type="date" id="subNextPayment" name="next_payment" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="subTrialEnd">–û–∫–æ–Ω—á–∞–Ω–∏–µ –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞</label>
                    <input type="date" id="subTrialEnd" name="trial_end_date">
                </div>

                <div class="form-group">
                    <label for="subDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="subDescription" name="description" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>
                </div>

                <div class="form-group">
                    <label for="subNotes">–ó–∞–º–µ—Ç–∫–∏</label>
                    <textarea id="subNotes" name="notes" rows="2" placeholder="–õ–∏—á–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏..."></textarea>
                </div>

                <div class="color-picker-group">
                    <label>–¶–≤–µ—Ç</label>
                    <div class="color-picker">
                        <input type="radio" name="color" value="#FF6B6B" id="color1" checked>
                        <label for="color1" style="background: #FF6B6B;"></label>
                        
                        <input type="radio" name="color" value="#4ECDC4" id="color2">
                        <label for="color2" style="background: #4ECDC4;"></label>
                        
                        <input type="radio" name="color" value="#45B7D1" id="color3">
                        <label for="color3" style="background: #45B7D1;"></label>
                        
                        <input type="radio" name="color" value="#96CEB4" id="color4">
                        <label for="color4" style="background: #96CEB4;"></label>
                        
                        <input type="radio" name="color" value="#FFEAA7" id="color5">
                        <label for="color5" style="background: #FFEAA7;"></label>
                        
                        <input type="radio" name="color" value="#A29BFE" id="color6">
                        <label for="color6" style="background: #A29BFE;"></label>
                    </div>
                </div>

                <input type="hidden" id="subId" name="id">

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary" id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Subscription Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content detail-modal">
            <div class="detail-header" id="detailHeader">
                <button class="modal-close" id="detailClose">&times;</button>
                <h2 id="detailName"></h2>
                <span class="detail-category" id="detailCategory"></span>
            </div>
            <div class="detail-body">
                <div class="detail-info">
                    <div class="info-item">
                        <span class="info-label">üí∞ –¶–µ–Ω–∞</span>
                        <span class="info-value" id="detailPrice"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">üìÖ –ü–µ—Ä–∏–æ–¥</span>
                        <span class="info-value" id="detailBilling"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">üóì –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</span>
                        <span class="info-value" id="detailStart"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">üîî –°–ª–µ–¥. –ø–ª–∞—Ç—ë–∂</span>
                        <span class="info-value" id="detailNext"></span>
                    </div>
                    <div class="info-item" id="trialInfo" style="display: none;">
                        <span class="info-label">‚è∞ –ö–æ–Ω–µ—Ü –ø—Ä–æ–±–Ω–æ–≥–æ</span>
                        <span class="info-value" id="detailTrial"></span>
                    </div>
                </div>
                <div class="detail-description" id="detailDescription" style="display: none;"></div>
                <div class="detail-notes" id="detailNotes" style="display: none;"></div>
            </div>
            <div class="detail-actions">
                <button class="btn btn-edit" id="editBtn">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn btn-toggle" id="toggleBtn">üîÑ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å</button>
                <button class="btn btn-delete" id="deleteBtn">üóë –£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Premium Limit Warning -->
    <div id="premiumModal" class="modal">
        <div class="modal-content premium-modal">
            <div class="premium-header">
                <h2>‚≠ê –û–±–Ω–æ–≤–∏—Ç–µ—Å—å –¥–æ Premium</h2>
                <button class="modal-close" id="premiumClose">&times;</button>
            </div>
            <div class="premium-body">
                <p>–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (5 –ø–æ–¥–ø–∏—Å–æ–∫).</p>
                <p>–û–±–Ω–æ–≤–∏—Ç–µ—Å—å –¥–æ Premium –¥–ª—è:</p>
                <ul class="premium-features">
                    <li>‚úÖ –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–æ–∫</li>
                    <li>üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</li>
                    <li>üì• –≠–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö</li>
                    <li>üé® –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö —Ç–µ–º</li>
                    <li>üö´ –ë–µ–∑ —Ä–µ–∫–ª–∞–º—ã</li>
                </ul>
                <div class="premium-price">–í—Å–µ–≥–æ $2.99/–º–µ—Å—è—Ü</div>
            </div>
            <div class="premium-actions">
                <button class="btn btn-premium" id="upgradePremium">‚≠ê –û—Ñ–æ—Ä–º–∏—Ç—å Premium</button>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
